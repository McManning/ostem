/*! OSTEM 18-01-2016 */
function enableEditables(){$(".editable").attr("contenteditable","true").on("blur.editable",function(){var a=$(this).html().trim();a.length||$(this).html("EDIT ME :("),$('.editable[data-editable-id="'+$(this).data("editable-id")+'"]').html($(this).html().trim())}),$("a").on("click.edit-mode",function(a){return a.preventDefault(),!1})}function disableEditables(){var a={};$(".editable").each(function(){$(this).removeAttr("contenteditable").off("blur.editable"),a[$(this).data("editable-id")]=$(this).html().trim()}),$("a").off("click.edit-mode"),$.post("/admin/update",a)}$(function(){if($(".collapsible").collapsible({accordion:!1}),$(".scrollspy").scrollSpy(),$(".parallax").parallax(),$(".modal-trigger").leanModal(),$(".tooltipped").tooltip({delay:0}),$(".button-collapse").sideNav({menuWidth:300,edge:"left"}),$(".toggle-editables").click(function(){return $(this).hasClass("active")?($(this).removeClass("active"),$(this).find("i").html("mode_edit"),disableEditables()):($(this).addClass("active"),$(this).find("i").html("save"),enableEditables()),!1}),$("form.sign-up input").focus(function(){$(this).siblings("label").html("What's your primary email?"),$(this).siblings(".signup").show()}),$("form.sign-up input").blur(function(){$(this).siblings("label").html("Join our mailing list!"),$(this).siblings("label").hasClass("active")||$(this).siblings(".signup").hide()}),$("form.sign-up").submit(function(a){var b=$(this),c=$(this).find("input").val();return c.length&&$.post("/subscribe",b.serialize()).done(function(){b.find(".input-field").hide(),b.find(".thanks").show()}).fail(function(){alert("Some sort of error occurred. That's not good :(")}),a.preventDefault(),!1}),$("#newsletter").length>0){var a=new Quill("#newsletter-editor",{modules:{toolbar:{container:"#newsletter-toolbar"},"link-tooltip":!0},theme:"snow"});$("#newsletter").submit(function(b){var c=$(this).find('button[type="submit"]');if(!c.hasClass("disabled")){if(a.getText().trim().length<1)return alert("You must enter some content!"),b.preventDefault(),!1;if($("#newsletter-subject").val().length<1)return alert("You must specify a newsletter subject!"),b.preventDefault(),!1;confirm("Are you sure you want to send this to all subscribers?")&&($("#newsletter-html").val(a.getHTML()),c.addClass("disabled").html('<i class="material-icons">email</i> Sending...'),$.post("/admin/newsletter/send",$("#newsletter").serialize()).fail(function(){c.removeClass("disabled").html('<i class="material-icons">send</i> Send Newsletter'),alert("An error has occurred!")}).done(function(){c.removeClass("disabled").html('<i class="material-icons">send</i> Send Newsletter'),a.setHTML(""),$("#newsletter-html").val(""),$("#newsletter-subject").val(""),alert("Newsletter has been sent!")}))}return b.preventDefault(),!1}),$("#newsletter .save").click(function(b){var c=$(this);return c.hasClass("disabled")||(c.addClass("disabled"),$("#newsletter-html").val(a.getHTML()),$.post("/admin/newsletter/draft",$("#newsletter").serialize()).fail(function(){c.removeClass("disabled"),alert("An error occurred while saving!")}).done(function(){c.removeClass("disabled")})),b.preventDefault(),!1}),$("#newsletter .clear").click(function(b){return confirm("Are you sure you want to clear the current draft?")?(a.setHTML(""),$("#newsletter-html").val(""),$("#newsletter-subject").val(""),$.post("/admin/newsletter/draft",$("#newsletter").serialize()),b.preventDefault(),!1):void 0})}if($("#profile").submit(function(a){var b=$(this),c=b.find("#password"),d=b.find("#password2");if(c.val().length>0){if(c.val()!==d.val())return alert("Passwords must match!"),a.preventDefault(),!1;$.post("/admin/profile",b.serialize()).fail(function(){alert("An error has occurred!")}).done(function(){alert("Profile updated!"),c.val(""),d.val("")})}return a.preventDefault(),!1}),$("#listserv").length>0){var b=$("#listserv").DataTable();$("#listserv-add").submit(function(a){return $.post("/subscribe",$(this).serialize()).fail(function(){alert("Err!")}).done(function(a){alert("Added! (Note: They won't be in the table until you refresh)")}),a.preventDefault(),!1}),$("#listserv").on("click","a.unsubscribe",function(){var a=$(this).closest("tr"),c=a.find("td.email").html(),d=a.find("td.email").data("uuid");return confirm("Are you sure you want to unsubscribe "+c+"?")&&$.post("/unsubscribe/"+d).fail(function(){alert("An error has occurred!")}).done(function(){b.row(a).remove().draw()}),!1})}});